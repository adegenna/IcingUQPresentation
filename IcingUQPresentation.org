#+STARTUP: beamer
#+LaTeX_CLASS: beamer
#+LaTeX_CLASS_OPTIONS: [9pt]

#+latex_header: \mode<beamer>{\usetheme{Warsaw}}
#+latex_header: \mode<beamer>{\setbeamertemplate{blocks}[rounded][shadow=false]}
#+latex_header: \mode<beamer>{\addtobeamertemplate{block begin}{\pgfsetfillopacity{0.8}}{\pgfsetfillopacity{1}}}
#+latex_header: \mode<beamer>{\setbeamercolor{structure}{fg=orange}}
#+latex_header: \mode<beamer>{\setbeamercovered{transparent}}
#+latex_header: \AtBeginSection[]{\begin{frame}<beamer>\frametitle{Topic}\tableofcontents[currentsection]\end{frame}}

#+latex_header: \usepackage{subcaption}
#+latex_header: \usepackage{multimedia}
#+latex_header: \usepackage{tikz}
#+latex_header: \usepackage{subfigure,subfigmat}
#+latex_header: \usepackage{threeparttable}
#+latex_header: \usetikzlibrary{shapes,arrows,shadows}

#+begin_latex
% Define my settings

\graphicspath{{Figures/}}
% Add Princeton shield logo
\addtobeamertemplate{frametitle}{}{%
\begin{tikzpicture}[remember picture,overlay]
\node[anchor=north east,yshift=2pt] at (current page.north east) {\includegraphics[height=0.7cm]{Shield}};
\end{tikzpicture}}
%
#+end_latex

#+latex_header: \newcommand{\bv}[1]{\mathbf{#1}}
#+latex_header: \newcommand{\diff}[2]{\frac{\partial #1}{\partial #2}}
#+latex_header: \newcommand{\beq}[0]{\begin{equation}}
#+latex_header: \newcommand{\eeq}[0]{\end{equation}}
#+latex_header: \newcommand{\beqa}[0]{\begin{eqnarray}}
#+latex_header: \newcommand{\eeqa}[0]{\end{eqnarray}}
#+latex_header: \newcommand{\beqq}[0]{\begin{equation*}}
#+latex_header: \newcommand{\eeqq}[0]{\end{equation*}}
#+latex_header: \newcommand{\bs}[1]{\boldsymbol{#1}}
#+latex_header: \newcommand{\ip}[2]{\langle #1, #2\rangle}
#+BEAMER_FRAME_LEVEL: 2



#+DATE: FAA JUP Meeting \\ Princeton, NJ \\ 13-14 April 2015
#+TITLE: Uncertainty Quantification for Airfoil Icing
#+AUTHOR: Anthony DeGennaro \newline Princeton University
\institute{Princeton University}


* Icing Parameterization

** Experimental/Computational Variation in Ice Shape

\begin{figure}
  \begin{subfigmatrix}{2}
      \subfigure[Habashi, 2006]{\includegraphics[width=0.45\textwidth]{Habashi2006ShapeVariation}}
      \subfigure[Wright, 2004]{\includegraphics[width=0.45\textwidth]{Wright2004ShapeVariation}}
  \end{subfigmatrix}
\end{figure}

- Variation in experimental/computational ice shapes
- Suggestive of random processes not fully modelled
- /UQ approach:/ parameterize the shape variation and study its
  effects on aerodynamics

** Canonical Airfoil Ice Shapes

#+begin_latex
\begin{columns}[c]
  \column{0.5\textwidth}
    \includegraphics[width=0.95\textwidth]{RidgeParameters}
  \column{0.5\textwidth}
    \includegraphics[width=0.95\textwidth]{NominalHorn}
\end{columns}
#+end_latex

- *Ridge Ice:*
  - Forms by refreezing of runback water
  - Generally aft of deicing equipment
- *Horn Ice:*
  - Leading edge protruberance
  - Can form quickly and be difficult to break up




* Low-Dimensional Parameter Space UQ

** Polynomial Chaos Expansions (PCE)

- *Polynomial Chaos Framework*
  - Let $\bv{Z} = (Z_1, Z_2)$ be random variables with PDF
    $\rho(\bv{Z})$ that parameterize ice
  - Let $\lbrace \Phi_k \rbrace$ denote the set of polynomials
    which are orthogonal w.r.t. $\rho(\bv{Z})$
  - Let $y(\bv{Z})$ denote the mapping from $\bv{Z}$ to an aerodynamic
    performance metric
- *Probabilistic Collocation Method:*
  - /Representation:/ $y(\bv{Z}) \approx \sum_{|i|=0}^N y_i \Phi_i(\bv{Z})$
  - /Orthonormality:/ $\ip{f}{g} = \int_{\Gamma} f(\bv{z})g(\bv{z})
    d\bv{z}$ where $\ip{\Phi_i}{\Phi_j} = \delta_{ij}$
  - /Quadrature:/ $y_k = \ip{y}{\Phi_k} \approx \sum_{i=0}^{Q}
    y(\bv{Z}^{(k)}) \Phi_k(\bv{Z}^{(k)}) w_k$

** Uncertainty Quantification Studies

#+begin_latex
\begin{columns}[c]
  \column{0.33\textwidth}
    \centering
    \includegraphics[width=0.95\textwidth]{RidgeRVariation} \\
    \includegraphics[width=0.95\textwidth]{RidgeSVariation} \\
    {\bf Ridge}
  \column{0.33\textwidth}
    \centering
    \includegraphics[width=0.95\textwidth]{HornHVariation} \\
    \includegraphics[width=0.95\textwidth]{HornSVariation} \\
    {\bf Horn}
  \column{0.33\textwidth}
    \centering    
    \includegraphics[width=0.9\textwidth]{MC_surrogate_LargeUnc_CL} \\
    \includegraphics[width=0.9\textwidth]{MCgpcPDFLargeUnc_CL} \\
    {\bf Statistics}
\end{columns}
#+end_latex

- PCE results required 25 samples; Monte Carlo required 500
- Nonlinear basis allows for wide variations in parameter space
- PCE surrogate is a smooth function
  - Monte Carlo sampling of the surrogate is cheap
  - Sensitivities are easily calculated




* Data-Based UQ

** Extracting Ice Shape Parameters from Data
\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{CRMHorn}
\end{figure}

- Previous approach was heuristic
- Would like a way of identifying shape parameters from data

** Low-Dimensional Modeling of Ice Shape Data
#+begin_latex
\begin{columns}[c]
  \column{0.3\textwidth}
    \centering
    \includegraphics[width=1.3\textwidth]{HornsUnaligned} \\
    \bf{Original Data}
  \column{0.3\textwidth}
    \centering
    \includegraphics[width=1.25\textwidth]{PODReconstruction2} \\
    {\bf POD Reconstruction}
  \column{0.3\textwidth}
    \centering
    \includegraphics[width=1.25\textwidth]{PODModes} \\
    {\bf POD Modes}
\end{columns}
#+end_latex
\vspace{1cm}
\begin{equation*}
N(s) = h \lbrace \bar{N}(as + b) + \sum_{i=1}^2 c_i \Phi_i(as + b)   \rbrace
\end{equation*}

- /h, a, b/ are scaling parameters
- $c_1, c_2$ are POD coefficients
- This collapses 100 different snapshots into 5 parameters

** PCE with Sparse Grids

#+begin_latex
\begin{columns}[c]
  \column{0.7\textwidth}
    \centering
    \includegraphics[width=0.95\textwidth]{SparseGrid1} \\
    \bf{Full Tensor Product vs. Sparse Grid}
  \column{0.3\textwidth}
    \centering
    \includegraphics[width=0.95\textwidth]{SparseGrid2} \\
    {\bf Anisotropic Grid}
\end{columns}
#+end_latex

- *Sparse Grids*
  - Sacrifice quadrature accuracy for efficiency
  - Only a subset of the full quadrature grid is used
  - Start with a coarse mesh, adaptively refine in most ``important"
    directions
  - For $d >> 1$, number of samples scales as $2^N {N+d \choose d} <<
    (N+1)^d$

** 5-Dimensional UQ Study

#+begin_latex
\begin{columns}[c]
  \column{0.25\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{DifferentShapesPODModes} \\
    \bf{POD Modes}
  \column{0.25\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{DifferentShapesHeight} \\
    {\bf Height}
  \column{0.25\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{DifferentShapesWidth} \\
    \bf{Width}
  \column{0.25\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{DifferentShapesPosition} \\
    {\bf Position}
\end{columns}
#+end_latex

- 5 dimensional parameter space
  - 2 POD coefficients (/shape/)
  - Width, height, position parameters (/scaling/)


** 5-Dimensional UQ Study Statistics

#+begin_latex
\begin{columns}[c]
  \column{0.33\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{PDFCLMAX} \\
    $\bm{C_{L_{MAX}}}$
  \column{0.33\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{PDFalphaMAX} \\
    $\bm{\alpha_{MAX}}$
  \column{0.33\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{PDFLDMAX} \\
    $\bm{L/D_{MAX}}$
\end{columns}

\begin{figure}
\centering
\includegraphics[width=0.5\textwidth]{Sobol}
\end{figure}
#+end_latex
- Sobol index $T_i = \frac{\mathbb{E}\left[ Var\left(
  Y|Z_{-i}\right)\right]}{Var\left( Y\right)}$ is a measure of how much
  $Z_i$ contributes to the total variance of $Y(\bv{Z})$
- Convergence based on $L_2$ norm of the surrogate covariance matrix
- TOL = $\left( 1, 0.5, 0.25 \right)$ required $\left( 71, 319, 543
  \right)$ samples
- Full $4^{th}$ order tensor grids would require $5^5 = 3,125$ samples  


* Computational-Based UQ

** Motivation
- *Investigate uncertainty in the physical process of icing*
  - Airfoils are exposed to supercooled droplets in icing conditions
  - The state of these droplets follows some distribution
  - Unclear how droplet distributions affect ice shape statistics
  - Experimental ice shapes can exhibit wide variation, even if
    exposed to similar icing conditions

#+begin_latex
\begin{columns}[c]
  \column{0.5\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{FAADropletDist1}
  \column{0.5\textwidth}
    \centering
    \includegraphics[width=1\textwidth]{FAADropletDist2}
\end{columns}
#+end_latex

- *Contribute to fast Lagrangian methods for droplet modeling*
  - Standard particle methods for icing are computationally intensive
    - ``Typical" conditions: $LWC=0.25 g/m^3$, $U = 100 m/s$, $MVD = 50 \mu m$
    - This gives free-stream droplet flux of 50 million droplets$/(m^2 s)$
  - Utilize techniques from spray modeling to reduce computational burden


** Airfoil Icing Code Flowchart 

#+begin_latex

% Define the layers to draw the diagram
\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

% Define block styles used later

\tikzstyle{sensor}=[draw, fill=blue!20, text width=5em, 
    text centered, minimum height=2.5em,drop shadow]
\tikzstyle{ann} = [above, text width=5em, text centered]
\tikzstyle{wa} = [sensor, text width=7.5em, fill=blue!20, 
    minimum height=3em, rounded corners, drop shadow]

% Define distances for bordering
\def\blockdist{2.3}
\def\edgedist{2.5}

\begin{tikzpicture}
    \node (CleanAirfoil) [wa]  {Clean Airfoil Geometry};
    \path (CleanAirfoil)+(4,2) node (FlowSolver) [wa] {Mesh/Flow Solver};
    \path (FlowSolver)+(0,-1.5) node (SLDModule) [wa] {Droplet\\Advection Module};
    \path (SLDModule)+(0,-1.5) node (ThermoModule) [wa] {Thermodynamic Module};
    \path (ThermoModule)+(0,-1.5) node (IcedAirfoil) [wa] {Iced Airfoil Geometry};
    \path (CleanAirfoil)+(8,0) node (FinalAirfoil) [wa] {Final Iced Airfoil Geometry};

    \path [draw, ->] (CleanAirfoil.north) |- node [above] {} (FlowSolver.west);
    \path [draw, ->] (FlowSolver.south) -- node [below] {} (SLDModule.north);
    \path [draw, ->] (SLDModule.south) -- node [below] {} (ThermoModule.north);
    \path [draw, ->] (ThermoModule.south) -- node [below] {} (IcedAirfoil.north);
    \path [draw, ->] (IcedAirfoil.east) -| node [above] {} (FinalAirfoil.south);
    \path [draw, ->] (IcedAirfoil.east) -- ++(0.75,0cm) |- node [above]
                      {} (FlowSolver.east);

    \begin{pgfonlayer}{background}
        \path (FlowSolver.west)+(-1,1) node (a) {};
        \path (IcedAirfoil.east)+(1,-1) node (b) {};
        \path[fill=orange!20,rounded corners, draw=black!50, dashed] (a) rectangle (b);
            
    \end{pgfonlayer}
    \begin{pgfonlayer}{background}
        \path (SLDModule.west)+(-0.5,0.75) node (a) {};
        \path (ThermoModule.east)+(0.5,-0.75) node (b) {};
        \path[fill=orange!40,rounded corners, draw=black!50, dashed] (a) rectangle (b);
            
    \end{pgfonlayer}

\end{tikzpicture}

#+end_latex

